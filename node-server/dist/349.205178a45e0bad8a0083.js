(self.webpackChunkblackbox=self.webpackChunkblackbox||[]).push([[349],{5349:(t,e,r)=>{"use strict";r.r(e),r.d(e,{SiModule:()=>Ft});var o=r(1116),s=r(1462),i=r(8366),n=r(4833),a=r(8619),c=r(2250),u=r(2290),l=r(3022),d=r(7719),p=r(322),m=r(9892),g=r(6726),h=r(4568),f=r(6239),Z=r(3454),b=r(1146),q=r(1956);const T=function(){return[""]};function C(t,e){1&t&&a._UZ(0,"img",50),2&t&&a.Q6J("routerLink",a.DdM(1,T))}function w(t,e){1&t&&a._uU(0," Profile Details ")}function A(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"*Enter all the required fields"),a.qZA())}function v(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"Email is already in use. Please try another!"),a.qZA())}function F(t,e){if(1&t&&a.YNc(0,v,2,0,"span",52),2&t){const t=a.oxw();a.Q6J("ngIf",t.profileFormSubmitted&&t.profileFormControls.email.errors&&t.profileFormControls.email.errors.exists)}}function x(t,e){1&t&&a._uU(0," Change Password ")}function y(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"*Enter all the required fields"),a.qZA())}function S(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"Wrong current password!"),a.qZA())}function k(t,e){if(1&t&&a.YNc(0,S,2,0,"span",28),2&t){const t=a.oxw(),e=a.MAs(80);a.Q6J("ngIf",t.passwordFormSubmitted&&t.passwordFormControls.currPassword.errors&&t.passwordFormControls.currPassword.errors.mustMatch)("ngIfElse",e)}}function U(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"New password & Confirm new password do not match!"),a.qZA())}function N(t,e){if(1&t&&a.YNc(0,U,2,0,"span",52),2&t){const t=a.oxw();a.Q6J("ngIf",t.passwordFormSubmitted&&t.passwordFormControls.confirmNewPassword.errors&&t.passwordFormControls.confirmNewPassword.errors.mustMatch)}}function _(t,e){1&t&&a._uU(0," Change Contact ")}function I(t,e){if(1&t&&(a.TgZ(0,"div",58),a._uU(1),a.qZA()),2&t){const t=a.oxw(3);a.xp6(1),a.hij("Resend OTP in ",t.resendSecCount," seconds.")}}function P(t,e){1&t&&(a.TgZ(0,"p-messages",56),a.YNc(1,I,2,1,"ng-template",57),a.qZA())}function J(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"a",59),a.NdJ("click",function(){a.CHM(t);const e=a.oxw(2);return e.resendOTP(e.contactForm.value)}),a._uU(1,"Resend OTP"),a.qZA()}}function D(t,e){if(1&t&&(a.TgZ(0,"div",53),a.YNc(1,P,2,0,"p-messages",54),a.YNc(2,J,2,0,"a",55),a.qZA()),2&t){const t=a.oxw();a.xp6(1),a.Q6J("ngIf",!t.showResend),a.xp6(1),a.Q6J("ngIf",t.showResend)}}function O(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"*Enter all the required fields"),a.qZA())}function Y(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"Contact number already in use. Please try another!"),a.qZA())}function E(t,e){if(1&t&&a.YNc(0,Y,2,0,"span",28),2&t){const t=a.oxw(),e=a.MAs(104);a.Q6J("ngIf",t.contactFormSubmitted&&t.contactFormControls.contact.errors&&t.contactFormControls.contact.errors.exists)("ngIfElse",e)}}function Q(t,e){1&t&&(a.TgZ(0,"span",51),a._uU(1,"Wrong OTP or contact number mismatched. Please try again!"),a.qZA())}function M(t,e){if(1&t&&a.YNc(0,Q,2,0,"span",52),2&t){const t=a.oxw();a.Q6J("ngIf",t.contactFormSubmitted&&!t.contactFormControls.otp.errors&&t.invalidOTP)}}const B=function(){return{width:"50vw"}},R=function(){return{width:"45vw"}};let j=(()=>{class t{constructor(t,e,r,o,s){this.tokenService=t,this.router=e,this.fb=r,this.userService=o,this.messageService=s,this.items=[],this.profileFormSubmitted=!1,this.showProfileDialog=!1,this.states=[],this.passwordFormSubmitted=!1,this.showPasswordDialog=!1,this.contactFormSubmitted=!1,this.showContactDialog=!1,this.otpSent=!1,this.invalidOTP=!1,this.showResend=!1,this.resendSecCount=30}ngOnInit(){this.user=this.tokenService.getUser(),this.items=[{label:this.user.fname,icon:"pi pi-user",items:[{label:"Profile",icon:"pi pi-user-edit",command:this.editProfile.bind(this)},{label:"Logout",icon:"pi pi-power-off",command:this.logout.bind(this)}]}],this.states=[{name:"Chhattisgarh",value:"Chhattisgarh"}],this.profileForm=this.fb.group({fname:[this.user.fname,s.kI.required],lname:[this.user.lname,s.kI.required],contact:[this.user.contact,s.kI.required],email:[this.user.email,s.kI.required],address:[this.user.address,s.kI.required],city:[this.user.city,s.kI.required],state:[{name:this.user.state,value:this.user.state},s.kI.required],pincode:[this.user.pincode,s.kI.required]},{validator:this.checkEmail()}),this.passwordForm=this.fb.group({currPassword:["",s.kI.required],newPassword:["",s.kI.required],confirmNewPassword:["",s.kI.required]},{validator:this.MustMatch()}),this.contactForm=this.fb.group({contact:["",s.kI.required],otp:[""]},{validator:this.checkContact()})}editProfile(){this.showProfileDialog=!0}submitProfileForm(t){Object.keys(this.profileFormControls).forEach(t=>{this.profileFormControls[t].markAsDirty()}),this.profileFormSubmitted=!0,this.profileForm.valid&&this.userService.updateProfile(t).subscribe(t=>{t.contact?(t.accessToken=this.tokenService.getToken(),this.tokenService.saveUser(t),this.messageService.add({severity:"success",summary:"Success",detail:"Profile updated successfully."}),this.showProfileDialog=!1):this.messageService.add({severity:"error",summary:"Error",detail:"Something went wrong. Please try again!"})})}editContact(){this.contactForm.reset(),this.contactFormSubmitted=!1,this.showContactDialog=!0}changePassword(){this.passwordForm.reset(),this.passwordFormSubmitted=!1,this.showPasswordDialog=!0}checkEmail(){return t=>{const e=t.controls.email;this.userService.checkEmailExists(e.value).subscribe(t=>{e.errors&&!e.errors.exists||e.setErrors("exists"==t.status?{exists:!0}:null)})}}MustMatch(){return t=>{const e=t.controls.newPassword,r=t.controls.confirmNewPassword,o=t.controls.currPassword;console.log("curr--\x3e ",o),console.log("new--\x3e ",e),console.log("confirm--\x3e ",o),this.userService.checkCurrPassword(o.value).subscribe(t=>{console.log("rrrr---\x3e> ",t),r.errors&&!r.errors.mustMatch||o.errors&&!o.errors.mustMatch||(r.setErrors(e.value!==r.value?{mustMatch:!0}:null),o.setErrors("match"==t.status?null:{mustMatch:!0}))})}}checkContact(){return t=>{const e=t.controls.contact;this.userService.checkContactExists(e.value).subscribe(t=>{e.errors&&!e.errors.exists||e.setErrors("exists"==t.status?{exists:!0}:null)})}}submitPasswordForm(t){Object.keys(this.passwordFormControls).forEach(t=>{this.passwordFormControls[t].markAsDirty()}),this.passwordFormSubmitted=!0,this.passwordForm.valid&&this.userService.updatePassword(t.newPassword).subscribe(t=>{"success"==t.status&&(this.messageService.add({severity:"success",summary:"Success",detail:"Password updated successfully."}),this.showPasswordDialog=!1)})}submitContactForm(t){Object.keys(this.contactFormControls).forEach(t=>{this.contactFormControls[t].markAsDirty()}),this.contactFormSubmitted=!0,this.contactForm.valid&&(this.otpSent?this.userService.updateContact(t.contact,t.otp.split("-").join("")).subscribe(e=>{e.contact?(e.accessToken=this.tokenService.getToken(),this.tokenService.saveUser(e),this.profileFormControls.contact.setValue(t.contact),this.messageService.add({severity:"success",summary:"Success",detail:"Contact updated successfully."}),this.showContactDialog=!1):this.messageService.add({severity:"error",summary:"Error",detail:"Something went wrong. Please try again!"})},t=>{this.messageService.add({severity:"error",summary:"Error",detail:"Wrong OTP or contact number mismatched. Please try again!"}),this.showContactDialog=!1}):this.userService.sendOTPForContactUpdate(t.contact).subscribe(t=>{console.log("rrrr",t),"success"==t.status&&(this.otpSent=!0,this.contactFormSubmitted=!1,this.contactFormControls.otp.setValidators([s.kI.required]),this.contactFormControls.otp.updateValueAndValidity(),this.startResendOtpTimer())}))}startResendOtpTimer(){this.showResend=!1,this.resendSecCount=30;var t=setInterval(()=>{this.resendSecCount--},1e3);setTimeout(()=>{clearInterval(t),this.showResend=!0},3e4)}resendOTP(t){this.userService.sendOTPForContactUpdate(t.contact).subscribe(t=>{console.log("rrrr",t),"success"==t.status&&this.startResendOtpTimer()})}get profileFormControls(){return this.profileForm.controls}get passwordFormControls(){return this.passwordForm.controls}get contactFormControls(){return this.contactForm.controls}logout(){this.tokenService.signOut(),this.router.navigate([""])}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(l.B),a.Y36(i.F0),a.Y36(s.qu),a.Y36(c.K),a.Y36(u.ez))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-header"]],features:[a._Bn([u.ez])],decls:109,vars:31,consts:[["styleClass","dashboard-menu",3,"model"],["pTemplate","start"],[1,"login-dialog",3,"visible","modal","visibleChange"],["pTemplate","header"],[1,"p-grid","p-fluid","p-pt-4"],[2,"width","100%",3,"formGroup","submit"],[1,"p-field","p-d-inline-block","p-col-12","p-md-6"],[1,"p-float-label"],["type","text","id","fname","pInputText","","formControlName","fname"],["for","fname",1,"required"],["type","text","id","lname","pInputText","","formControlName","lname"],["for","lname",1,"required"],["type","text","id","contact","pInputText","","formControlName","contact",2,"width","90%",3,"readOnly"],["for","contact",1,"required"],["pButton","","type","button","icon","pi pi-pencil","title","Edit Contact",1,"p-button-text","p-button-warning",2,"width","9%",3,"click"],["type","text","id","email","pInputText","","formControlName","email"],["for","email",1,"required"],[1,"p-field","p-d-inline-block","p-col-12","p-md-12"],["type","text","id","address","pInputText","","formControlName","address"],["for","address",1,"required"],[1,"p-field","p-d-inline-block","p-col-12","p-md-4"],["type","text","id","city","pInputText","","formControlName","city"],["for","city",1,"required"],["inputId","state","formControlName","state","optionLabel","name",3,"autoDisplayFirst","options"],["for","state",1,"required"],["type","text","id","pincode","pInputText","","formControlName","pincode"],["for","pincode",1,"required"],[1,"p-col-12","p-md-12","p-d-inline-block"],["class","p-error",4,"ngIf","ngIfElse"],["else1",""],[1,"p-col-12","p-md-6","p-d-inline-block"],["pButton","","pRipple","","label","Change Password","icon","pi pi-unlock","type","button",1,"p-button-outlined","p-button-help",2,"width","auto",3,"click"],[1,"p-col-12","p-md-6","p-text-right","p-d-inline-block"],["pButton","","pRipple","","label","Cancel","type","button",1,"p-button-outlined","p-button-secondary",2,"width","auto",3,"click"],["pButton","","pRipple","","label","Update","type","submit",1,"p-button-outlined",2,"width","auto","margin-left","15px"],["type","text","id","currPassword","pInputText","","formControlName","currPassword"],["for","currPassword",1,"required"],["type","text","id","newPassword","pInputText","","formControlName","newPassword"],["for","newPassword",1,"required"],["type","text","id","confirmNewPassword","pInputText","","formControlName","confirmNewPassword"],["for","confirmNewPassword",1,"required"],["else2",""],["else3",""],["type","text","id","contact","pInputText","","formControlName","contact"],["id","otp","mask","9-9-9-9","formControlName","otp",3,"disabled"],["for","otp",1,"required"],["class","p-col-12",4,"ngIf"],["else4",""],["else5",""],["pButton","","pRipple","","type","submit",1,"p-button-outlined",2,"width","auto","margin-left","15px",3,"label"],["src","assets/landing/logo.svg",1,"p-mr-2",2,"cursor","pointer",3,"routerLink"],[1,"p-error"],["class","p-error",4,"ngIf"],[1,"p-col-12"],["severity","info",4,"ngIf"],["href","javascript:;","style","color: #fff;",3,"click",4,"ngIf"],["severity","info"],["pTemplate",""],[1,"p-ml-2"],["href","javascript:;",2,"color","#fff",3,"click"]],template:function(t,e){if(1&t&&(a.TgZ(0,"p-menubar",0),a.YNc(1,C,1,2,"ng-template",1),a.qZA(),a.TgZ(2,"p-dialog",2),a.NdJ("visibleChange",function(t){return e.showProfileDialog=t}),a.YNc(3,w,1,0,"ng-template",3),a.TgZ(4,"div",4),a.TgZ(5,"form",5),a.NdJ("submit",function(){return e.submitProfileForm(e.profileForm.value)}),a.TgZ(6,"div",6),a.TgZ(7,"span",7),a._UZ(8,"input",8),a.TgZ(9,"label",9),a._uU(10,"First Name"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(11,"div",6),a.TgZ(12,"span",7),a._UZ(13,"input",10),a.TgZ(14,"label",11),a._uU(15,"Last Name"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(16,"div",6),a.TgZ(17,"span",7),a._UZ(18,"input",12),a.TgZ(19,"label",13),a._uU(20,"Contact"),a.qZA(),a.TgZ(21,"button",14),a.NdJ("click",function(){return e.editContact()}),a.qZA(),a.qZA(),a.qZA(),a.TgZ(22,"div",6),a.TgZ(23,"span",7),a._UZ(24,"input",15),a.TgZ(25,"label",16),a._uU(26,"E-mail"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(27,"div",17),a.TgZ(28,"span",7),a._UZ(29,"input",18),a.TgZ(30,"label",19),a._uU(31,"Address"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(32,"div",20),a.TgZ(33,"span",7),a._UZ(34,"input",21),a.TgZ(35,"label",22),a._uU(36,"City"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(37,"div",20),a.TgZ(38,"span",7),a._UZ(39,"p-dropdown",23),a.TgZ(40,"label",24),a._uU(41,"State"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(42,"div",20),a.TgZ(43,"span",7),a._UZ(44,"input",25),a.TgZ(45,"label",26),a._uU(46,"Pincode"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(47,"div",27),a.YNc(48,A,2,0,"span",28),a.YNc(49,F,1,1,"ng-template",null,29,a.W1O),a.qZA(),a.TgZ(51,"div",30),a.TgZ(52,"button",31),a.NdJ("click",function(){return e.changePassword()}),a.qZA(),a.qZA(),a.TgZ(53,"div",32),a.TgZ(54,"button",33),a.NdJ("click",function(){return e.showProfileDialog=!1}),a.qZA(),a._UZ(55,"button",34),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(56,"p-dialog",2),a.NdJ("visibleChange",function(t){return e.showPasswordDialog=t}),a.YNc(57,x,1,0,"ng-template",3),a.TgZ(58,"div",4),a.TgZ(59,"form",5),a.NdJ("submit",function(){return e.submitPasswordForm(e.passwordForm.value)}),a.TgZ(60,"div",17),a.TgZ(61,"span",7),a._UZ(62,"input",35),a.TgZ(63,"label",36),a._uU(64,"Current Password"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(65,"div",17),a.TgZ(66,"span",7),a._UZ(67,"input",37),a.TgZ(68,"label",38),a._uU(69,"New Password"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(70,"div",17),a.TgZ(71,"span",7),a._UZ(72,"input",39),a.TgZ(73,"label",40),a._uU(74,"Confirm New Password"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(75,"div",30),a.YNc(76,y,2,0,"span",28),a.YNc(77,k,1,2,"ng-template",null,41,a.W1O),a.YNc(79,N,1,1,"ng-template",null,42,a.W1O),a.qZA(),a.TgZ(81,"div",32),a.TgZ(82,"button",33),a.NdJ("click",function(){return e.showPasswordDialog=!1}),a.qZA(),a._UZ(83,"button",34),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(84,"p-dialog",2),a.NdJ("visibleChange",function(t){return e.showContactDialog=t}),a.YNc(85,_,1,0,"ng-template",3),a.TgZ(86,"div",4),a.TgZ(87,"form",5),a.NdJ("submit",function(){return e.submitContactForm(e.contactForm.value)}),a.TgZ(88,"div",17),a.TgZ(89,"span",7),a._UZ(90,"input",43),a.TgZ(91,"label",13),a._uU(92,"Contact"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(93,"div",17),a.TgZ(94,"span",7),a._UZ(95,"p-inputMask",44),a.TgZ(96,"label",45),a._uU(97,"OTP"),a.qZA(),a.qZA(),a.qZA(),a.YNc(98,D,3,2,"div",46),a.TgZ(99,"div",30),a.YNc(100,O,2,0,"span",28),a.YNc(101,E,1,2,"ng-template",null,47,a.W1O),a.YNc(103,M,1,1,"ng-template",null,48,a.W1O),a.qZA(),a.TgZ(105,"div",32),a.TgZ(106,"button",33),a.NdJ("click",function(){return e.showContactDialog=!1}),a.qZA(),a._UZ(107,"button",49),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a._UZ(108,"p-toast")),2&t){const t=a.MAs(50),r=a.MAs(78),o=a.MAs(102);a.Q6J("model",e.items),a.xp6(2),a.Akn(a.DdM(28,B)),a.Q6J("visible",e.showProfileDialog)("modal",!0),a.xp6(3),a.Q6J("formGroup",e.profileForm),a.xp6(13),a.Q6J("readOnly",!0),a.xp6(21),a.Q6J("autoDisplayFirst",!1)("options",e.states),a.xp6(9),a.Q6J("ngIf",e.profileFormSubmitted&&(e.profileFormControls.address.errors&&e.profileFormControls.address.errors.required||e.profileFormControls.fname.errors&&e.profileFormControls.fname.errors.required||e.profileFormControls.lname.errors&&e.profileFormControls.lname.errors.required||e.profileFormControls.contact.errors&&e.profileFormControls.contact.errors.required||e.profileFormControls.email.errors&&e.profileFormControls.email.errors.required||e.profileFormControls.city.errors&&e.profileFormControls.city.errors.required||e.profileFormControls.state.errors&&e.profileFormControls.state.errors.required||e.profileFormControls.pincode.errors&&e.profileFormControls.pincode.errors.required))("ngIfElse",t),a.xp6(8),a.Akn(a.DdM(29,R)),a.Q6J("visible",e.showPasswordDialog)("modal",!0),a.xp6(3),a.Q6J("formGroup",e.passwordForm),a.xp6(17),a.Q6J("ngIf",e.passwordFormSubmitted&&(e.passwordFormControls.currPassword.errors&&e.passwordFormControls.currPassword.errors.required||e.passwordFormControls.newPassword.errors&&e.passwordFormControls.newPassword.errors.required||e.passwordFormControls.confirmNewPassword.errors&&e.passwordFormControls.confirmNewPassword.errors.required))("ngIfElse",r),a.xp6(8),a.Akn(a.DdM(30,R)),a.Q6J("visible",e.showContactDialog)("modal",!0),a.xp6(3),a.Q6J("formGroup",e.contactForm),a.xp6(8),a.Q6J("disabled",!e.otpSent),a.xp6(3),a.Q6J("ngIf",e.otpSent),a.xp6(2),a.Q6J("ngIf",e.contactFormSubmitted&&(e.contactFormControls.contact.errors&&e.contactFormControls.contact.errors.required||e.contactFormControls.otp.errors&&e.contactFormControls.otp.errors.required))("ngIfElse",o),a.xp6(7),a.s9C("label",e.otpSent?"Update":"Send OTP")}},directives:[d.nm,u.jx,p.V,s._Y,s.JL,s.sg,s.Fj,m.o,s.JJ,s.u,g.Hq,h.Lt,o.O5,f.H,Z.vy,b.FN,i.rH,q.V],styles:[""]}),t})();var L=r(9065);function V(t,e){if(1&t&&(a.TgZ(0,"th"),a._uU(1),a.qZA()),2&t){const t=e.$implicit;a.xp6(1),a.hij(" ",t.header," ")}}function $(t,e){1&t&&(a.TgZ(0,"th"),a._uU(1," Action "),a.qZA())}function H(t,e){if(1&t&&(a.TgZ(0,"tr"),a.YNc(1,V,2,1,"th",7),a.YNc(2,$,2,0,"th",8),a.qZA()),2&t){const t=e.$implicit,r=a.oxw();a.xp6(1),a.Q6J("ngForOf",t),a.xp6(1),a.Q6J("ngIf","closed"!==r.caseStatus)}}function W(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"button",10),a.NdJ("click",function(){a.CHM(t);const e=a.oxw(2).$implicit;return a.oxw().openImage(e.image)}),a.qZA()}}function z(t,e){if(1&t&&(a.TgZ(0,"td"),a._uU(1),a.YNc(2,W,1,0,"button",9),a.qZA()),2&t){const t=e.$implicit,r=a.oxw().$implicit;a.xp6(1),a.hij(" ","user"==t.field?r.user.fname+" "+r.user.lname:"userContact"==t.field?r.user.contact:"userEmail"==t.field?r.user.email:"image"!==t.field?r[t.field]:""," "),a.xp6(1),a.Q6J("ngIf","image"==t.field&&"Motion Detection"==r.name)}}function G(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"td"),a.TgZ(1,"button",11),a.NdJ("click",function(){a.CHM(t);const e=a.oxw().$implicit;return a.oxw().changeCaseStatus(e.id)}),a.qZA(),a.qZA()}if(2&t){const t=a.oxw(2);a.xp6(1),a.Gre("p-button-outlined ","open"==t.caseStatus?"p-button-success":"p-button-warning",""),a.MGl("icon","pi ","open"==t.caseStatus?"pi-check-circle":"pi-play",""),a.s9C("label","new"==t.caseStatus?"Set as Open":"open"==t.caseStatus?"Set as Closed":"")}}function X(t,e){if(1&t&&(a.TgZ(0,"tr"),a.YNc(1,z,3,2,"td",7),a.YNc(2,G,2,5,"td",8),a.qZA()),2&t){const t=e.columns,r=a.oxw();a.xp6(1),a.Q6J("ngForOf",t),a.xp6(1),a.Q6J("ngIf","closed"!==r.caseStatus)}}function K(t,e){if(1&t&&(a.TgZ(0,"tr"),a.TgZ(1,"td",12),a._uU(2," No case found. "),a.qZA(),a.qZA()),2&t){const t=e.$implicit,r=a.oxw();a.xp6(1),a.uIk("colspan","closed"!==r.caseStatus?t.length+1:t.length)}}const tt=function(){return["/si/dashboard"]};let et=(()=>{class t{constructor(t,e,r,o){this.route=t,this.userService=e,this.router=r,this.window=o,this.cols=[],this.cases=[]}ngOnInit(){this.cols=[{field:"name",header:"Case"},{field:"user",header:"Customer"},{field:"userEmail",header:"Contact"},{field:"userContact",header:"Email"},{field:"createdAt",header:"Date/Time"},{field:"image",header:"Image"}],this.caseStatusSub=this.route.params.subscribe(t=>this.loadCases(t.status))}loadCases(t){this.caseStatus=t,"new"==this.caseStatus?this.userService.getSICases("new").subscribe(t=>{this.cases=t.cases}):"open"==this.caseStatus?this.userService.getSICases("open").subscribe(t=>{this.cases=t.cases}):"closed"==this.caseStatus?this.userService.getSICases("closed").subscribe(t=>{this.cases=t.cases}):this.router.navigate(["/user/dashboard"])}changeCaseStatus(t){"new"==this.caseStatus?this.userService.setCaseOpen(t).subscribe(t=>{"success"==t.status&&this.loadCases(this.caseStatus)}):"open"==this.caseStatus&&this.userService.setCaseClose(t).subscribe(t=>{"success"==t.status&&this.loadCases(this.caseStatus)})}openImage(t){console.log("host",t);const e=this.window.open(t,"_blank");e&&e.focus()}ngOnDestroy(){this.caseStatusSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(i.gz),a.Y36(c.K),a.Y36(i.F0),a.Y36(n.m))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-case"]],decls:9,vars:4,consts:[[1,"dashboard-page","p-grid"],[1,"p-col-12"],["pButton","","pRipple","","icon","pi pi-arrow-left","label","Go Back","type","button",1,"p-button-outlined","p-button-secondary",3,"routerLink"],[3,"columns","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pButton","","pRipple","","class","p-button-outlined p-button-rounded p-button-info","icon","pi pi-image","type","button",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-image","type","button",1,"p-button-outlined","p-button-rounded","p-button-info",3,"click"],["pButton","","pRipple","","iconPos","right","type","button",3,"icon","label","click"],[1,"p-text-center"]],template:function(t,e){1&t&&(a._UZ(0,"app-header"),a.TgZ(1,"div",0),a.TgZ(2,"div",1),a._UZ(3,"button",2),a.qZA(),a.TgZ(4,"div",1),a.TgZ(5,"p-table",3),a.YNc(6,H,3,2,"ng-template",4),a.YNc(7,X,3,2,"ng-template",5),a.YNc(8,K,3,1,"ng-template",6),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(3),a.Q6J("routerLink",a.DdM(3,tt)),a.xp6(2),a.Q6J("columns",e.cols)("value",e.cases))},directives:[j,g.Hq,f.H,i.rH,L.iA,u.jx,o.sg,o.O5],styles:[""]}),t})();function rt(t,e){if(1&t&&(a.TgZ(0,"th"),a._uU(1),a.qZA()),2&t){const t=e.$implicit;a.xp6(1),a.hij(" ",t.header," ")}}function ot(t,e){if(1&t&&(a.TgZ(0,"tr"),a.YNc(1,rt,2,1,"th",37),a.TgZ(2,"th"),a._uU(3," Action "),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(1),a.Q6J("ngForOf",t)}}function st(t,e){if(1&t&&(a.TgZ(0,"td"),a._uU(1),a.qZA()),2&t){const t=e.$implicit,r=a.oxw().$implicit;a.xp6(1),a.hij(" ","name"==t.field?r.fname+" "+r.lname:"address"==t.field?r.address+", "+r.city+", "+r.pincode:r[t.field]," ")}}function it(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"tr"),a.YNc(1,st,2,1,"td",37),a.TgZ(2,"td"),a.TgZ(3,"button",38),a.NdJ("click",function(){const e=a.CHM(t).$implicit;return a.oxw().openEditCustomerDialog(e)}),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=e.columns;a.xp6(1),a.Q6J("ngForOf",t)}}function nt(t,e){if(1&t&&(a.TgZ(0,"tr"),a.TgZ(1,"td",39),a._uU(2," No users found. "),a.qZA(),a.qZA()),2&t){const t=e.$implicit;a.xp6(1),a.uIk("colspan",t.length)}}function at(t,e){1&t&&a._uU(0," Edit Customer ")}function ct(t,e){1&t&&(a.TgZ(0,"span",40),a._uU(1,"*Enter all the required fields"),a.qZA())}function ut(t,e){1&t&&(a.TgZ(0,"span",40),a._uU(1,"Email is already in use. Please try another!"),a.qZA())}function lt(t,e){if(1&t&&a.YNc(0,ut,2,0,"span",31),2&t){const t=a.oxw(),e=a.MAs(58);a.Q6J("ngIf",t.customerFormSubmitted&&t.customerFormControls.email.errors&&t.customerFormControls.email.errors.exists)("ngIfElse",e)}}function dt(t,e){1&t&&(a.TgZ(0,"span",40),a._uU(1,"Contact is already in use. Please try another!"),a.qZA())}function pt(t,e){if(1&t&&a.YNc(0,dt,2,0,"span",41),2&t){const t=a.oxw();a.Q6J("ngIf",t.customerFormSubmitted&&t.customerFormControls.contact.errors&&t.customerFormControls.contact.errors.exists)}}const mt=function(){return["/si/dashboard"]},gt=function(){return{width:"75vw"}};let ht=(()=>{class t{constructor(t,e,r){this.userService=t,this.fb=e,this.messageService=r,this.cols=[],this.users=[],this.showEditCustomerDialog=!1,this.states=[],this.customerFormSubmitted=!1}ngOnInit(){this.cols=[{field:"name",header:"Name"},{field:"contact",header:"Contact"},{field:"email",header:"E-mail"},{field:"address",header:"Address"}],this.getUsers(),this.states=[{name:"Chhattisgarh",value:"Chhattisgarh"}],this.customerForm=this.fb.group({fname:["",s.kI.required],lname:["",s.kI.required],contact:["",s.kI.required],email:["",s.kI.required],address:["",s.kI.required],city:["",s.kI.required],state:["",s.kI.required],pincode:["",s.kI.required]})}getUsers(){this.userService.getSiUsers().subscribe(t=>{this.users=t.users})}openEditCustomerDialog(t){console.log("user",t),this.customerForm.reset(),this.customerFormControls.fname.setValue(t.fname),this.customerFormControls.lname.setValue(t.lname),this.customerFormControls.contact.setValue(t.contact),this.customerFormControls.email.setValue(t.email),this.customerFormControls.address.setValue(t.address),this.customerFormControls.city.setValue(t.city),this.customerFormControls.state.setValue(t.state),this.customerFormControls.pincode.setValue(t.pincode),this.showEditCustomerDialog=!0}submitCustomerForm(t){Object.keys(this.customerFormControls).forEach(t=>{this.customerFormControls[t].markAsDirty()}),this.customerFormSubmitted=!0,this.customerForm.valid&&this.userService.editUser(t).subscribe(t=>{"success"==t.status&&(this.showEditCustomerDialog=!1,this.getUsers(),this.messageService.add({severity:"success",summary:"Success",detail:"Customer updated successfully."}))},t=>{this.messageService.add({severity:"error",summary:"Error",detail:t.error.message})})}get customerFormControls(){return this.customerForm.controls}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(c.K),a.Y36(s.qu),a.Y36(u.ez))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-customer"]],features:[a._Bn([u.ez])],decls:62,vars:15,consts:[[1,"dashboard-page","p-grid"],[1,"p-col-12"],["pButton","","pRipple","","icon","pi pi-arrow-left","label","Go Back","type","button",1,"p-button-outlined","p-button-secondary",3,"routerLink"],[3,"columns","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"login-dialog",3,"visible","visibleChange"],[1,"p-grid","p-fluid","p-pt-4"],[2,"width","100%",3,"formGroup","submit"],[1,"p-field","p-d-inline-block","p-col-12","p-md-6"],[1,"p-float-label"],["type","text","id","fname","pInputText","","formControlName","fname"],["for","fname",1,"required"],["type","text","id","lname","pInputText","","formControlName","lname"],["for","lname",1,"required"],["type","text","id","contact","pInputText","","formControlName","contact",3,"readOnly"],["for","contact",1,"required"],["type","text","id","email","pInputText","","formControlName","email",3,"readOnly"],["for","email",1,"required"],[1,"p-field","p-d-inline-block","p-col-12","p-md-12"],["type","text","id","address","pInputText","","formControlName","address"],["for","address",1,"required"],[1,"p-field","p-d-inline-block","p-col-12","p-md-4"],["type","text","id","city","pInputText","","formControlName","city"],["for","city",1,"required"],["inputId","state","formControlName","state","optionLabel","name",3,"autoDisplayFirst","options"],["for","state",1,"required"],["type","text","id","pincode","pInputText","","formControlName","pincode"],["for","pincode",1,"required"],[1,"p-col-12","p-md-6","p-d-inline-block"],["class","p-error",4,"ngIf","ngIfElse"],["else1",""],["else2",""],[1,"p-col-12","p-md-6","p-d-inline-block","p-text-right"],["pButton","","pRipple","","label","Cancel","type","button",1,"p-button-outlined","p-button-secondary",2,"width","auto",3,"click"],["pButton","","pRipple","","label","Add","type","submit",1,"p-button-outlined",2,"width","auto","margin-left","15px"],[4,"ngFor","ngForOf"],["pButton","","pRipple","","icon","pi pi-user-edit","type","button",1,"p-button-outlined","p-button-warning",3,"click"],[1,"p-text-center"],[1,"p-error"],["class","p-error",4,"ngIf"]],template:function(t,e){if(1&t&&(a._UZ(0,"app-header"),a.TgZ(1,"div",0),a.TgZ(2,"div",1),a._UZ(3,"button",2),a.qZA(),a.TgZ(4,"div",1),a.TgZ(5,"p-table",3),a.YNc(6,ot,4,1,"ng-template",4),a.YNc(7,it,4,1,"ng-template",5),a.YNc(8,nt,3,1,"ng-template",6),a.qZA(),a.qZA(),a.qZA(),a.TgZ(9,"p-dialog",7),a.NdJ("visibleChange",function(t){return e.showEditCustomerDialog=t}),a.YNc(10,at,1,0,"ng-template",4),a.TgZ(11,"div",8),a.TgZ(12,"form",9),a.NdJ("submit",function(){return e.submitCustomerForm(e.customerForm.value)}),a.TgZ(13,"div",10),a.TgZ(14,"span",11),a._UZ(15,"input",12),a.TgZ(16,"label",13),a._uU(17,"First Name"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(18,"div",10),a.TgZ(19,"span",11),a._UZ(20,"input",14),a.TgZ(21,"label",15),a._uU(22,"Last Name"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(23,"div",10),a.TgZ(24,"span",11),a._UZ(25,"input",16),a.TgZ(26,"label",17),a._uU(27,"Contact"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(28,"div",10),a.TgZ(29,"span",11),a._UZ(30,"input",18),a.TgZ(31,"label",19),a._uU(32,"E-mail"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(33,"div",20),a.TgZ(34,"span",11),a._UZ(35,"input",21),a.TgZ(36,"label",22),a._uU(37,"Address"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(38,"div",23),a.TgZ(39,"span",11),a._UZ(40,"input",24),a.TgZ(41,"label",25),a._uU(42,"City"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(43,"div",23),a.TgZ(44,"span",11),a._UZ(45,"p-dropdown",26),a.TgZ(46,"label",27),a._uU(47,"State"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(48,"div",23),a.TgZ(49,"span",11),a._UZ(50,"input",28),a.TgZ(51,"label",29),a._uU(52,"Pincode"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(53,"div",30),a.YNc(54,ct,2,0,"span",31),a.YNc(55,lt,1,2,"ng-template",null,32,a.W1O),a.YNc(57,pt,1,1,"ng-template",null,33,a.W1O),a.qZA(),a.TgZ(59,"div",34),a.TgZ(60,"button",35),a.NdJ("click",function(){return e.showEditCustomerDialog=!1}),a.qZA(),a._UZ(61,"button",36),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&t){const t=a.MAs(56);a.xp6(3),a.Q6J("routerLink",a.DdM(13,mt)),a.xp6(2),a.Q6J("columns",e.cols)("value",e.users),a.xp6(4),a.Akn(a.DdM(14,gt)),a.Q6J("visible",e.showEditCustomerDialog),a.xp6(3),a.Q6J("formGroup",e.customerForm),a.xp6(13),a.Q6J("readOnly",!0),a.xp6(5),a.Q6J("readOnly",!0),a.xp6(15),a.Q6J("autoDisplayFirst",!1)("options",e.states),a.xp6(9),a.Q6J("ngIf",e.customerFormSubmitted&&(e.customerFormControls.address.errors&&e.customerFormControls.address.errors.required||e.customerFormControls.fname.errors&&e.customerFormControls.fname.errors.required||e.customerFormControls.lname.errors&&e.customerFormControls.lname.errors.required||e.customerFormControls.contact.errors&&e.customerFormControls.contact.errors.required||e.customerFormControls.email.errors&&e.customerFormControls.email.errors.required||e.customerFormControls.city.errors&&e.customerFormControls.city.errors.required||e.customerFormControls.state.errors&&e.customerFormControls.state.errors.required||e.customerFormControls.pincode.errors&&e.customerFormControls.pincode.errors.required))("ngIfElse",t)}},directives:[j,g.Hq,f.H,i.rH,L.iA,u.jx,p.V,s._Y,s.JL,s.sg,s.Fj,m.o,s.JJ,s.u,h.Lt,o.O5,o.sg],styles:[""]}),t})();var ft=r(8751);const Zt=function(){return["/si/cases/new"]},bt=function(){return["/si/cases/open"]},qt=function(){return["/si/cases/closed"]},Tt=function(){return["/si/customers"]},Ct=[{path:"dashboard",component:(()=>{class t{constructor(t){this.userService=t}ngOnInit(){this.userService.getSIDashboardData().subscribe(t=>{console.log("dashCounts",t),this.dashboardData=t})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(c.K))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-dashboard"]],decls:34,vars:12,consts:[[1,"p-grid","dashboard-page"],[1,"p-col-4","p-text-center"],[3,"routerLink"],[1,"p-col-2"]],template:function(t,e){1&t&&(a._UZ(0,"app-header"),a.TgZ(1,"div",0),a.TgZ(2,"div",1),a.TgZ(3,"p-card",2),a.TgZ(4,"h1"),a._uU(5,"New Cases"),a.qZA(),a.TgZ(6,"h3"),a._uU(7),a.qZA(),a.qZA(),a.qZA(),a.TgZ(8,"div",1),a.TgZ(9,"p-card",2),a.TgZ(10,"h1"),a._uU(11,"Open Cases"),a.qZA(),a.TgZ(12,"h3"),a._uU(13),a.qZA(),a.qZA(),a.qZA(),a.TgZ(14,"div",1),a.TgZ(15,"p-card",2),a.TgZ(16,"h1"),a._uU(17,"Closed Cases"),a.qZA(),a.TgZ(18,"h3"),a._uU(19),a.qZA(),a.qZA(),a.qZA(),a._UZ(20,"div",3),a.TgZ(21,"div",1),a.TgZ(22,"p-card",2),a.TgZ(23,"h1"),a._uU(24,"Customers"),a.qZA(),a.TgZ(25,"h3"),a._uU(26),a.qZA(),a.qZA(),a.qZA(),a.TgZ(27,"div",1),a.TgZ(28,"p-card"),a.TgZ(29,"h1"),a._uU(30,"Earnings"),a.qZA(),a.TgZ(31,"h3"),a._uU(32,"0"),a.qZA(),a.qZA(),a.qZA(),a._UZ(33,"div",3),a.qZA()),2&t&&(a.xp6(3),a.Q6J("routerLink",a.DdM(8,Zt)),a.xp6(4),a.Oqu(e.dashboardData?e.dashboardData.newCaseCount:0),a.xp6(2),a.Q6J("routerLink",a.DdM(9,bt)),a.xp6(4),a.Oqu(e.dashboardData?e.dashboardData.openCaseCount:0),a.xp6(2),a.Q6J("routerLink",a.DdM(10,qt)),a.xp6(4),a.Oqu(e.dashboardData?e.dashboardData.closedCaseCount:0),a.xp6(3),a.Q6J("routerLink",a.DdM(11,Tt)),a.xp6(4),a.Oqu(e.dashboardData?e.dashboardData.usersCount:0))},directives:[j,ft.Z,i.rH],styles:[""]}),t})()},{path:"customers",component:ht},{path:"cases/:status",component:et},{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"**",redirectTo:"dashboard",pathMatch:"full"}];let wt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[i.Bz.forChild(Ct)],i.Bz]}),t})();var At=r(3581),vt=r(6094);let Ft=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[o.ez,wt,d.W6,ft.d,L.U$,g.hJ,f.T,At.D,b.EV,m.j,p.S,Z.zz,q.$,vt.O,h.kW,s.UX]]}),t})()}}]);